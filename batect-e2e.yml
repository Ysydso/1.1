containers:
  diary-e2e:
    image: node:14.6.0
    working_directory: /app
    command: yarn
    volumes:
      - local: .
        container: /app
      - type: cache
        name: client-node-modules
        container: /app/node_modules

tasks:
  e2e:
    prerequisites:
      - server-setup
      - server-codegen
      - client-setup
    dependencies:
      - diary-server
      - diary-client
    run:
      container: diary-e2e
      command: curl diary-client:3000
